# 部分提示模板

与其他方法一样，对提示模板进行“部分”处理是有意义的 - 例如，传入所需值的一个子集，以创建一个只期望剩余子集值的新提示模板。

LangChain 以两种方式支持这一点：

1. 使用字符串值的部分格式化。
2. 使用返回字符串值的函数的部分格式化。


这两种不同的方式支持不同的用例。在下面的示例中，我们将讨论这两种用例的动机以及如何在LangChain中实现它们。

## 使用字符串的部分

一个常见的需要部分化提示模板的用例是，如果您先获得一些变量，然后再获得其他变量。
例如，假设您有一个需要两个变量 `foo` 和`baz` 的提示模板。如果您在链中的早期获取了 `foo` 值，
但稍后获取了 `baz` 值，那么等待直到在同一位置拥有两个变量再将它们传递给提示模板可能会很麻烦。
相反，您可以部分化提示模板与 `foo` 值，然后传递部分化的提示模板，并只使用它。下面是一个这样做的例子：

```typescript
import { PromptTemplate } from "langchain/prompts";

const prompt = new PromptTemplate({
  template: "{foo}{bar}",
  inputVariables: ["foo", "bar"],
});

const partialPrompt = await prompt.partial({
  foo: "foo",
});

const formattedPrompt = await partialPrompt.format({
  bar: "baz",
});

console.log(formattedPrompt);

// foobaz
```

您还可以直接使用部分化的变量初始化提示。

```typescript
const prompt = new PromptTemplate({
  template: "{foo}{bar}",
  inputVariables: ["bar"],
  partialVariables: {
    foo: "foo",
  },
});

const formattedPrompt = await prompt.format({
  bar: "baz",
});

console.log(formattedPrompt);

// foobaz
```

## 使用函数的部分

您还可以使用函数来部分化。这种情况的用例是当您知道您总是希望以常见的方式获取一个变量时。
其中一个典型例子是日期或时间。想象一下，您有一个始终希望包含当前日期的提示。
您不能在提示中硬编码它，并且将其与其他输入变量一起传递可能很麻烦。在这种情况下，
能够使用一个始终返回当前日期的函数来部分化提示非常方便。

```typescript
const getCurrentDate = () => {
  return new Date().toISOString();
};

const prompt = new PromptTemplate({
  template: "告诉我一个关于{date}的{adjective}笑话",
  inputVariables: ["adjective", "date"],
});

const partialPrompt = await prompt.partial({
  date: getCurrentDate,
});

const formattedPrompt = await partialPrompt.format({
  adjective: "funny",
});

console.log(formattedPrompt);

// 告诉我一个关于2023-07-13T00:54:59.287Z的funny笑话
```

你也可以使用部分变量初始化提示：

```typescript
const prompt = new PromptTemplate({
  template: "告诉我一个关于{date}的{adjective}笑话",
  inputVariables: ["adjective"],
  partialVariables: {
    date: getCurrentDate,
  },
});

const formattedPrompt = await prompt.format({
  adjective: "funny",
});

console.log(formattedPrompt);

// 告诉我一个关于2023-07-13T00:54:59.287Z的funny笑话
```


