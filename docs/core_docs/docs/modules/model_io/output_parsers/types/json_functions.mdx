---
sidebar_position: 2
---
# JSON 输出函数解析器

import CodeBlock from "@theme/CodeBlock";
import JSONFunctions from "@examples/prompts/json_structured_output_parser.ts";
import StreamingJSONFunctions from "@examples/prompts/json_structured_output_parser_streaming.ts";

JSON 输出函数解析器是一种用于解析结构化 JSON 函数响应的实用工具，例如来自 [OpenAI 函数](/docs/modules/model_io/chat/function_calling)的响应。当您需要从复杂的 JSON 响应中提取特定信息时，该解析器特别有用。

它的工作原理如下：

1. **输出解析器**：你可以传入一个预定义的 `outputParser` 或者解析器将使用默认的 `OutputFunctionsParser`。

2. **默认行为**：如果使用默认的 `OutputFunctionsParser`，它将从响应生成中提取函数调用并对其应用 `JSON.stringify`。

3. **argsOnly 参数**：如果 `argsOnly` 参数设置为 true，解析器将只返回函数调用的参数，不对响应应用 `JSON.stringify`。

4. **响应解析**：然后再次解析输出解析器的响应，并返回结果。

让我们看一个例子：

import IntegrationInstallTooltip from "@mdx_components/integration_install_tooltip.mdx";

<IntegrationInstallTooltip></IntegrationInstallTooltip>

```bash npm2yarn
npm install @langchain/openai
```

<CodeBlock language="typescript">{JSONFunctions}</CodeBlock>

在这个例子中，我们首先定义了一个函数模式并实例化了 `ChatOpenAI` 类。
然后，我们通过将函数绑定到模型并将输出通过 `JsonOutputFunctionsParser` 进行管道传输来创建一个可运行实例。
当我们使用输入调用可运行实例时，由于输出解析器的存在，响应已经被解析了。


结果将是一个包含来自函数调用的解析响应的 JSON 对象。

## 流式处理

此解析器还适用于以流式方式解析函数响应。它支持聚合函数响应或 [JSON 补丁](https://jsonpatch.com/)差异：


<CodeBlock language="typescript">{StreamingJSONFunctions}</CodeBlock>

